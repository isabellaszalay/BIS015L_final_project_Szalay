---
title: "how_to_become_a_billionaire_analysis"
output: html_document
date: "2023-03-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown



------

```{r}
billionaires %>%
  count(category)
```

## App that shows final worth of billionaires by the field they are in

```{r}
companies
```

```{r}
billionaires%>% 
  select(person_name, final_worth, category) %>%
  arrange(-final_worth) %>%
  head(10)%>%
  ggplot(aes(x=person_name, y=final_worth, fill=category))+ 
  geom_col(alpha=0.4) + 
  facet_wrap(~category, ncol=2)+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  labs(title = "Final Worth by Billionaire and Field",
       x = NULL,
       y = "Final Worth",
       fill = "Field")
```

```{r}
library(shiny)

ui <- fluidPage(titlePanel("Final Worth by Billionaire and Field"),
                radioButtons("x", "Select Fill Variable", choices=c("Automotive", "Diversified", "Fashion & Retail", "Finance & Investments", "Technology" ),
                             selected="Automotive"),
                plotOutput("plot")
  
)

server <- function(input, output, session) {
  output$plot <- renderPlot({
    billionaires %>%
    select(person_name, final_worth, category) %>%
      arrange(-final_worth) %>%
      head(10)%>%
      ggplot(aes(x=person_name, y=final_worth, fill=category))+ 
      geom_col(alpha=0.4) +  
      theme_light(base_size=18) +
      theme(axis.text.x = element_text(angle = 60, hjust = 1))
  })
  
}

shinyApp(ui, server)

```

- issues 
  cannot facet wrap field with billionaires and final worth. 
  instead of billionaires maybe their positions??? 

```{r}
billionaires %>% 
  select(person_name, final_worth, category) %>%
  arrange(-final_worth) %>%
  head(10)%>%
  ggplot(aes(x=person_name, y=final_worth, fill=category))+ 
  geom_col(alpha=0.4) + 
  facet_wrap(~category, ncol=2)+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  labs(title = "Final Worth by Billionaire and Field",
       x = NULL,
       y = "Final Worth",
       fill = "Field")
```

## Mutate NPM to add field

```{r}
companies_NPM_new <- companies_NPM %>%
  mutate(category=case_when(
    global_company =="Shenzhen Feima International Supply Chain Co., Ltd." ~ "Logistics",
    global_company =="Porsche Automobil Holding" ~ "Automotive",
    global_company =="Sofina" ~ "Finance & Investments",
    global_company =="PT Saratoga Investama Sedaya" ~ "Finance & Investments",
    global_company =="3i Group" ~ "Finance & Investments",
    global_company == "Info Edge India" ~ "Technology",
    global_company == "Kinnevik" ~ "Finance & Investments",
    global_company == "Segro" ~ "Real Estate",
    global_company == "Akelius Residential Property" ~ "Real Estate",
    global_company == "Power Assets Holdings" ~ "Energy"))
```

```{r}
companies_NPM_new
```
## 

```{r}
companies_NPM %>%
  ggplot(aes(x=profit_bil, y=sales_bil)) + 
  geom_jitter()
```

```{r}
companies_NPM %>%
  count(country) %>%
  arrange(-n)
```
```{r}
#install.packages("shinydashboard")
```


```{r}
library(shinydashboard)
ui <- dashboardPage(
  dashboardHeader(title="NPM by Country"),
  dashboardSidebar(disable=T),
  dashboardBody(
  selectInput("x", "Select Country", choices = c("United States", "Sweden", "Canada", "China", "Hong Kong", "United Kingdom", "Germany", "France", "Saudi Arabia", "Switzerland"), 
              selected = "United States"),
  sliderInput("pointsize", "Select the Point Size", min=.5, max=5, value=2.5, step=.5),
  plotOutput("plot", width="500px", height= "400px"))
  
)

server <- function(input, output, session) {
  session$onSessionEnded(stopApp)
  output$plot <- renderPlot({
    companies_NPM %>%
      filter(country==input$x) %>%
        ggplot(aes(x=profit_bil, y=sales_bil)) + 
  geom_point(size=input$pointsize) +
      theme_light()
    
  })
  
}

shinyApp(ui, server)
```


## Mutating the profit/revenue column for net profit margin - is there a correlation between profit margins and market value?
```{r}
companies_NPM <- companies %>% 
  mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>% 
  filter(global_company != "Bradespar") %>% 
  arrange(-net_profit_margin_percent) %>%
  head(100)
companies_NPM
```

## Mutating the assets to sales ratio
```{r}
companies %>% 
  mutate(assets_sales_ratio = assets_bil/sales_bil) %>% 
  filter(global_company != "Bradespar") %>% 
  arrange(-assets_sales_ratio) %>% 
  head(10)
```

## Comparison of highest market value to lowest market value

Highest market value - top 10
```{r}
companies_MV_high <- companies %>% 
  arrange(-market_value_bil) %>% 
  head(10) %>% 
  select(global_company, country, market_value_bil) %>% 
  ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
  geom_col(color = "black")+
  coord_flip()+
  labs(title = " Highest Market Values of the Top 10 Global Companies by Country",
       x = "Market Value",
       y = "Global Company")
```

```{r}
companies_MV_high+
  theme_light()+
  theme(plot.title = element_text(size = 10, face = "bold"),
        axis.title = element_text(size=10),
        axis.text.x = element_text(size=9, hjust=1))
```

Lowest Market Value - Lower 10
```{r}
companies_MV_low <- companies %>% 
  arrange(market_value_bil) %>% 
  head(10) %>% 
  select(global_company, country, market_value_bil) %>% 
  ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
  geom_col(color = "black")+
  coord_flip()+
  labs(title = "Lowest Market Values of the Top 10 Global Companies by Country",
       x = "Market Value",
       y = "Global Company")
```

```{r}
companies_MV_low+
  theme_light()+
  theme(plot.title = element_text(size = 10, face = "bold"),
        axis.title = element_text(size=10),
        axis.text.x = element_text(size=9, hjust=1))
```

## Trying to find the companies with the best market value and net profit margins - ask during OH
```{r}
companies_1 <- companies %>% 
  mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>% 
  filter(global_company != "Bradespar") %>% 
  arrange(-net_profit_margin_percent)
```

```{r}
companies_1 %>% 
  arrange(-market_value_bil)
```

## Billionaire data
```{r}
billionaires_country <- billionaires %>% 
  count(country) %>% 
  arrange(-n) %>% 
  head(10) %>% 
  ggplot(aes(x=reorder(country,n), y=n))+
  geom_col(color = "black", fill ="coral1")+
  coord_flip()+
  labs(title = "No. of Billionaires by Country",
       x = "Country",
       y = "Number of Billionaires")
```

```{r}
billionaires_country+
  theme_light()+
  theme(plot.title = element_text(size = 10, face = "bold"),
        axis.title = element_text(size=10),
        axis.text.x = element_text(size=9, hjust=1))
```
## Companies by country Pie Chart
```{r}
companies %>% 
  count(country) %>% 
  arrange(-n) %>% 
  head(10) %>% 
  ggplot(aes(x=country, y=n, fill=country))+
  geom_col()+
  coord_polar()
```
```{r}
prop <- c(590, 297, 196, 65, 64, 58, 55, 54, 54, 52)
pie(prop)
```

```{r}
myPalette <- brewer.pal(9, "BuPu")
pie(prop, labels = c("US", "China", "Japan", "S.Korea", "UK", "Canada", "India", "France", "Hong Kong", "Germany"), border = "black", col=myPalette)
```
