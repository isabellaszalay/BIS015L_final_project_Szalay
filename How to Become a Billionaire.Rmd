---
title: "How to Become a Billionaire"
output: html_document
date: "2023-02-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("tidyverse")

library("janitor")

library("naniar")
```

```{r}
getwd()
```

```{r}
billionaires<- read.csv("forbes_dataset_2022/forbes_billionaires_2022.csv", na="")
billionaires
```
```{r}
billionaires <- janitor::clean_names(billionaires)
```

```{r}
companies <- read.csv("forbes_dataset_2022/forbes_companies_2022.csv", na="")
companies
```
mutate_at
case_when
new column that is just b or m 
separate 
regex

```{r}
companies <- companies %>%
    separate(sales, into=c("sales", "factor1"), sep=" ")
```

```{r}
companies <- companies %>%
  separate(profit, into=c("profit", "factor2"), sep=" ")
```


```{r}
companies <- companies %>%
  separate(assets, into=c("assets", "factor3"), sep=" ")
```


```{r}
companies <- companies %>%
  separate(market.value, into=c("market.value", "factor4"), sep=" ")
```


```{r}
companies$sales = gsub("\\$", "", companies$sales)
companies$sales = as.numeric(companies$sales)

```
```{r}
companies
```


```{r}
companies$profit=as.numeric(gsub("\\$", "", companies$profit))
```

```{r}
companies$assets = gsub(",","", companies$assets)
companies$assets = gsub("\\$","", companies$assets)
companies$assets = as.numeric(companies$assets)
```

```{r}
companies$market.value = gsub(",","", companies$market.value)
companies$market.value = gsub("\\$","", companies$market.value)
companies$market.value = as.numeric(companies$market.value)
```


```{r}
companies
```

```{r}
companies$assets=as.numeric(gsub("\\$", "", companies$assets))
```

```{r}
companies_new1 <- companies %>%
  gsub(",","", assets)
```

```{r}
companies$market.value=as.numeric(gsub("\\$", "", companies$market.value))
```

```{r}
companies
```





```{r}
companies$sales
```


```{r}
companies %>%
  mutate_at(c("sales", "profit", "assets", "market.value"), remove."$", na.rm=T)
```


```{r}
companies <- janitor::clean_names(companies)
```

```{r}
glimpse(billionaires)
```

```{r}
glimpse(companies)
```

```{r}
naniar::miss_var_summary(billionaires)
```

- "about" isn't important for analyzing data

- "state" NAs refer to people outside the US

- "title" may not have a current working position especially if they are not involved in an organization

- "philanthropyScore" interesting metric but a lot of data is not available - we might still be able to do something with this or find additional data.

- "organization" some wealth is from family, or several different organizations, we still have field they work in and source of wealth so hopefully that is okay 


```{r}
naniar::miss_var_summary(companies)
```

- checked through data, NAs are represented as "NA" and "" but switched all "" to "NA"


## things we may want to analyze for: 

filter country to US - look at which states produce the most billionaires

*what country has the most assests/profits?

histogram: frequency of people born over span of years 

*connecting final worth of billionaires to the field they are in - can optimize to see which field produces the highest profit margins 

something with final worth and if they are self made or not 

separate the B in the sales, profits, assets and market value columns and change them to factor so that calculations can be performed on them

mutate net profit margin = net profit/revenue * 100 - can be an indicator of the company's stability of income (shows whether a company is reliable or not)

can filter for the top 10 companies that have the highest net profit margin and market value - a combination of both would indicate a very stable company, can make a bar plot to "show" the highest of both (like on the last question of the midterm)

we can then use the top 10 companies to see which country comes up the highest (likely the US) and then connect these to the billionaires data
