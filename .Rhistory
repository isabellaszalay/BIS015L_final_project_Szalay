geom_col()+
coord_flip()
billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col()+
coord_flip()
billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n, fill = country))+
geom_col()+
coord_flip()
billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n, fill = country))+
geom_col()+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = NULL,
y = "Number of Billionaires")
billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n, fill = country))+
geom_col()+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col()+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
billionaires_country <- billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col()+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
colors <- paletteer::palettes_d_names
my_palette <- paletteer_d("ggsci::deep_purple_material")
display.brewer.pal(5,"PiYG")
library(RColorBrewer)
library(paletteer)
display.brewer.pal(5,"PiYG")
display.brewer.pal(3,"BuPu")
axis.text.x = element_text(size=9, hjust=1)
billionaires_country+
scale_fill_brewer(palette = "BuPu")+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
billionaires_country
display.brewer.pal(10,"BuPu")
billionaires_country+
scale_fill_brewer(palette = "BuPu")+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
colors <- paletteer::palettes_d_names
my_palette <- paletteer_d("ggsci::deep_purple_material")
billionaires_country+
scale_fill_brewer(values = my_palette)+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
billionaires_country <- billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col(color = "darkgoldenrod2", fill ="coral1")+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
billionaires_country+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
billionaires_country <- billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col(color = "black", fill ="coral1")+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
billionaires_country+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
companies %>%
mutate(assets_sales_ratio = assets_bil/sales_bil) %>%
filter(global_company != "Bradespar") %>%
arrange(-assets_sales_ratio) %>%
head(10)
companies_MV_high <- companies %>%
arrange(-market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col()+
coord_flip()+
labs(title = " Highest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_high+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
companies_MV_low <- companies %>%
arrange(market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col()+
coord_flip()+
labs(title = "Lowest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_high <- companies %>%
arrange(-market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col(color = "black")+
coord_flip()+
labs(title = " Highest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_high+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
companies_MV_low <- companies %>%
arrange(market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col(color = "black")+
coord_flip()+
labs(title = "Lowest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_low+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
companies_1 <- companies %>%
mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>%
filter(global_company != "Bradespar") %>%
arrange(-net_profit_margin_percent)
companies_1 %>%
arrange(-market_value_bil)
billionaires_country <- billionaires %>%
count(country) %>%
arrange(-n) %>%
head(10) %>%
ggplot(aes(x=reorder(country,n), y=n))+
geom_col(color = "black", fill ="coral1")+
coord_flip()+
labs(title = "No. of Billionaires by Country",
x = "Country",
y = "Number of Billionaires")
billionaires_country+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
knitr::opts_chunk$set(echo = TRUE)
billionaires<- read.csv("forbes_dataset_2022/forbes_billionaires_2022.csv", na="")
billionaires
billionaires <- janitor::clean_names(billionaires)
billionaires
companies_NPM <- companies %>%
mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>%
filter(global_company != "Bradespar") %>%
arrange(-net_profit_margin_percent) %>%
head(10)
companies_NPM <- companies %>%
mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>%
filter(global_company != "Bradespar") %>%
arrange(-net_profit_margin_percent) %>%
head(10)
knitr::opts_chunk$set(echo = TRUE)
billionaires
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("janitor")
library("naniar")
library(RColorBrewer)
library(paletteer)
getwd()
billionaires<- read.csv("forbes_dataset_2022/forbes_billionaires_2022.csv", na="")
billionaires
billionaires <- janitor::clean_names(billionaires)
naniar::miss_var_summary(billionaires)
companies <- read.csv("forbes_dataset_2022/forbes_companies_2022.csv", na="")
companies
companies <- janitor::clean_names(companies)
naniar::miss_var_summary(companies)
companies <- companies %>%
separate(sales, into=c("sales", "factor1"), sep=" ")
companies <- companies %>%
separate(profit, into=c("profit", "factor2"), sep=" ")
companies <- companies %>%
separate(assets, into=c("assets", "factor3"), sep=" ")
companies <- companies %>%
separate(market_value, into=c("market_value", "factor4"), sep=" ")
companies$sales = gsub("\\$", "", companies$sales)
companies$sales = as.numeric(companies$sales)
companies$profit=as.numeric(gsub("\\$", "", companies$profit))
companies$assets = gsub(",","", companies$assets)
companies$assets = gsub("\\$","", companies$assets)
companies$assets = as.numeric(companies$assets)
companies$market_value = gsub(",","", companies$market_value)
companies$market_value = gsub("\\$","", companies$market_value)
companies$market_value = as.numeric(companies$market_value)
companies <- companies %>%
mutate(across(c(sales), ~ case_when(factor1 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(profit), ~ case_when(factor2 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(assets), ~ case_when(factor3 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(market_value), ~ case_when(factor4 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
select(-factor1, -factor2, -factor3, -factor4)
companies <- companies %>%
rename(sales_bil = "sales", profit_bil = "profit", assets_bil = "assets", market_value_bil = "market_value")
billionaires
library(shinydashboard)
ui <- dashboardPage(
dashboardHeader(title="NPM by Country"),
dashboardSidebar(disable=T),
dashboardBody(
fluidRow(
box(
selectInput("x", "Select Country", choices = c("United States", "Sweden", "Canada", "China", "Hong Kong", "United Kingdom", "Germany", "France", "Saudi Arabia", "Switzerland"),
selected = "United States"),
sliderInput("pointsize", "Select the Point Size", min=.5, max=5, value=2.5, step=.5)
),
box(
plotOutput("plot", width="600px", height= "500px"))
)
)
)
knitr::opts_chunk$set(echo = TRUE)
billionaires
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth)
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("janitor")
library("naniar")
library(RColorBrewer)
library(paletteer)
getwd()
billionaires<- read.csv("forbes_dataset_2022/forbes_billionaires_2022.csv", na="")
billionaires
billionaires <- janitor::clean_names(billionaires)
naniar::miss_var_summary(billionaires)
companies <- read.csv("forbes_dataset_2022/forbes_companies_2022.csv", na="")
companies
companies <- janitor::clean_names(companies)
naniar::miss_var_summary(companies)
companies <- companies %>%
separate(sales, into=c("sales", "factor1"), sep=" ")
companies <- companies %>%
separate(profit, into=c("profit", "factor2"), sep=" ")
companies <- companies %>%
separate(assets, into=c("assets", "factor3"), sep=" ")
companies <- companies %>%
separate(market_value, into=c("market_value", "factor4"), sep=" ")
companies$sales = gsub("\\$", "", companies$sales)
companies$sales = as.numeric(companies$sales)
companies$profit=as.numeric(gsub("\\$", "", companies$profit))
companies$assets = gsub(",","", companies$assets)
companies$assets = gsub("\\$","", companies$assets)
companies$assets = as.numeric(companies$assets)
companies$market_value = gsub(",","", companies$market_value)
companies$market_value = gsub("\\$","", companies$market_value)
companies$market_value = as.numeric(companies$market_value)
companies <- companies %>%
mutate(across(c(sales), ~ case_when(factor1 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(profit), ~ case_when(factor2 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(assets), ~ case_when(factor3 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
mutate(across(c(market_value), ~ case_when(factor4 == "M"~ .x/1000,
TRUE ~ .x)))
companies <- companies %>%
select(-factor1, -factor2, -factor3, -factor4)
companies <- companies %>%
rename(sales_bil = "sales", profit_bil = "profit", assets_bil = "assets", market_value_bil = "market_value")
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth)
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth) %>%
count(states)
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth) %>%
count(state)
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth)
billionaires %>%
select(rank, person_name, final_worth, state) %>%
filter(state!="NA") %>%
arrange(-final_worth) %>%
count(state) %>%
arrange(-n)
knitr::opts_chunk$set(echo = TRUE)
billionaires
billionaires %>%
count(category) %>%
arrange(-n)
billionaires %>%
arrange(-final_worth) %>%
separate(birth_date, into = c("month", "date", "year"), sep ="/") %>%
filter(year!= "NA") %>%
select(rank, person_name, final_worth, category, age, year, month) %>%
count(year) %>%
arrange(-n)
billionaires %>%
arrange(-final_worth) %>%
separate(birth_date, into = c("month", "date", "year"), sep ="/") %>%
filter(year!= "NA") %>%
select(rank, person_name, final_worth, category, age, year, month) %>%
count(year) %>%
ggplot(aes(x=year, y=n))+
geom_col()+
theme(plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size=8),
axis.text.x = element_text(size=5, angle = 80, hjust=1))+
labs(title = "Distribution of the No. of Billionaires by Year of Birth",
x = "Year of Birth",
y = "No. of Billionaires")
billionaires%>%
select(person_name, final_worth, category) %>%
arrange(-final_worth) %>%
head(10)%>%
ggplot(aes(x=person_name, y=final_worth, fill=category))+
geom_col(alpha=0.4) +
facet_wrap(~category, ncol=2)+
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
labs(title = "Final Worth by Billionaire and Field",
x = NULL,
y = "Final Worth",
fill = "Field")
companies_NPM_new <- companies_NPM %>%
mutate(category=case_when(
global_company =="Shenzhen Feima International Supply Chain Co., Ltd." ~ "Logistics",
global_company =="Porsche Automobil Holding" ~ "Automotive",
global_company =="Sofina" ~ "Finance & Investments",
global_company =="PT Saratoga Investama Sedaya" ~ "Finance & Investments",
global_company =="3i Group" ~ "Finance & Investments",
global_company == "Info Edge India" ~ "Technology",
global_company == "Kinnevik" ~ "Finance & Investments",
global_company == "Segro" ~ "Real Estate",
global_company == "Akelius Residential Property" ~ "Real Estate",
global_company == "Power Assets Holdings" ~ "Energy"))
companies_NPM %>%
ggplot(aes(x=profit_bil, y=sales_bil)) +
geom_point()
companies_NPM <- companies %>%
mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>%
filter(global_company != "Bradespar") %>%
arrange(-net_profit_margin_percent) %>%
head(100)
companies_NPM
companies_NPM_new <- companies_NPM %>%
mutate(category=case_when(
global_company =="Shenzhen Feima International Supply Chain Co., Ltd." ~ "Logistics",
global_company =="Porsche Automobil Holding" ~ "Automotive",
global_company =="Sofina" ~ "Finance & Investments",
global_company =="PT Saratoga Investama Sedaya" ~ "Finance & Investments",
global_company =="3i Group" ~ "Finance & Investments",
global_company == "Info Edge India" ~ "Technology",
global_company == "Kinnevik" ~ "Finance & Investments",
global_company == "Segro" ~ "Real Estate",
global_company == "Akelius Residential Property" ~ "Real Estate",
global_company == "Power Assets Holdings" ~ "Energy"))
companies_NPM %>%
ggplot(aes(x=profit_bil, y=sales_bil)) +
geom_point()
companies_NPM %>%
count(country) %>%
arrange(-n)
#install.packages("shinydashboard")
library(shinydashboard)
companies_NPM <- companies %>%
mutate(net_profit_margin_percent = profit_bil/sales_bil *100) %>%
filter(global_company != "Bradespar") %>%
arrange(-net_profit_margin_percent) %>%
head(100)
companies_NPM
companies %>%
mutate(assets_sales_ratio = assets_bil/sales_bil) %>%
filter(global_company != "Bradespar") %>%
arrange(-assets_sales_ratio) %>%
head(10)
companies_profit <- companies %>%
arrange(-profit_bil) %>%
select(rank, global_company, country, profit_bil, market_value_bil) %>%
mutate(category=case_when(
global_company =="Saudi Arabian Oil Company (Saudi Aramco)" ~ "Energy",
global_company =="Apple" ~ "Technology",
global_company =="Berkshire Hathaway" ~ "Finance & Investments",
global_company =="Alphabet" ~ "Technology",
global_company =="Microsoft" ~ "Technology",
global_company == "ICBC" ~ "Finance & Investments",
global_company == "China Construction Bank" ~ "Finance & Investments",
global_company == "JPMorgan Chase" ~ "Finance & Investments",
global_company == "Meta Platforms" ~ "Technology",
global_company == "Agricultural Bank of China" ~ "Finance & Investments",
global_company == "Tencent Holdings" ~ "Technology",
global_company == "Samsung Group" ~ "Technology",
global_company == "Bank of China" ~ "Finance & Investments",
global_company == "Amazon" ~ "Technology",
global_company == "Bank of America" ~ "Finance & Investments",
global_company == "Vivendi" ~ "Media & Entertainment",
global_company == "Toyota Motor" ~ "Automotive",
global_company == "Mercedes-Benz Group" ~ "Automotive",
global_company == "Gazprom" ~ "Energy",
global_company == "Novartis" ~ "Healthcare"
))
companies_profit %>%
head(20) %>%
count(category) %>%
arrange(-n)
billionaires %>%
select(rank, person_name, final_worth, category, country) %>%
arrange(-final_worth) %>%
head(20) %>%
count(category) %>%
arrange(-n)
companies_MV_high <- companies %>%
arrange(-market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col(color = "black")+
coord_flip()+
labs(title = " Highest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_high+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
companies_MV_low <- companies %>%
arrange(market_value_bil) %>%
head(10) %>%
select(global_company, country, market_value_bil) %>%
ggplot(aes(x=reorder(global_company, market_value_bil), y=market_value_bil, fill = country))+
geom_col(color = "black")+
coord_flip()+
labs(title = "Lowest Market Values of the Top 10 Global Companies by Country",
x = "Market Value",
y = "Global Company")
companies_MV_low+
theme_light()+
theme(plot.title = element_text(size = 10, face = "bold"),
axis.title = element_text(size=10),
axis.text.x = element_text(size=9, hjust=1))
